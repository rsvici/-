!function(){"use strict";var t=function(t){THREE.MeshBasicMaterial.call(this),this.depthTest=!1,this.depthWrite=!1,this.side=THREE.FrontSide,this.transparent=!0,this.setValues(t),this.oldColor=this.color.clone(),this.oldOpacity=this.opacity,this.highlight=function(t){t?(this.color.setRGB(1,1,0),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}};(t.prototype=Object.create(THREE.MeshBasicMaterial.prototype)).constructor=t;var e=function(t){THREE.LineBasicMaterial.call(this),this.depthTest=!1,this.depthWrite=!1,this.transparent=!0,this.linewidth=1,this.setValues(t),this.oldColor=this.color.clone(),this.oldOpacity=this.opacity,this.highlight=function(t){t?(this.color.setRGB(1,1,0),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}};(e.prototype=Object.create(THREE.LineBasicMaterial.prototype)).constructor=e;var n=new t({visible:!1,transparent:!1});THREE.TransformGizmo=function(){this.init=function(){THREE.Object3D.call(this),this.handles=new THREE.Object3D,this.pickers=new THREE.Object3D,this.planes=new THREE.Object3D,this.add(this.handles),this.add(this.pickers),this.add(this.planes);var t=new THREE.PlaneBufferGeometry(50,50,2,2),e=new THREE.MeshBasicMaterial({visible:!1,side:THREE.DoubleSide}),n={XY:new THREE.Mesh(t,e),YZ:new THREE.Mesh(t,e),XZ:new THREE.Mesh(t,e),XYZE:new THREE.Mesh(t,e)};this.activePlane=n.XYZE,n.YZ.rotation.set(0,Math.PI/2,0),n.XZ.rotation.set(-Math.PI/2,0,0);for(var a in n)n[a].name=a,this.planes.add(n[a]),this.planes[a]=n[a];var o=function(t,e){for(var n in t)for(a=t[n].length;a--;){var o=t[n][a][0],i=t[n][a][1],r=t[n][a][2];o.name=n,i&&o.position.set(i[0],i[1],i[2]),r&&o.rotation.set(r[0],r[1],r[2]),e.add(o)}};o(this.handleGizmos,this.handles),o(this.pickerGizmos,this.pickers),this.traverse(function(t){if(t instanceof THREE.Mesh){t.updateMatrix();var e=t.geometry.clone();e.applyMatrix(t.matrix),t.geometry=e,t.position.set(0,0,0),t.rotation.set(0,0,0),t.scale.set(1,1,1)}})},this.highlight=function(t){this.traverse(function(e){e.material&&e.material.highlight&&(e.name===t?e.material.highlight(!0):e.material.highlight(!1))})}},THREE.TransformGizmo.prototype=Object.create(THREE.Object3D.prototype),THREE.TransformGizmo.prototype.constructor=THREE.TransformGizmo,THREE.TransformGizmo.prototype.update=function(t,e){var n=new THREE.Vector3(0,0,0),a=new THREE.Vector3(0,1,0),o=new THREE.Matrix4;this.traverse(function(i){-1!==i.name.search("E")?i.quaternion.setFromRotationMatrix(o.lookAt(e,n,a)):-1===i.name.search("X")&&-1===i.name.search("Y")&&-1===i.name.search("Z")||i.quaternion.setFromEuler(t)})},THREE.TransformGizmoTranslate=function(){THREE.TransformGizmo.call(this);var a=new THREE.Geometry,o=new THREE.Mesh(new THREE.CylinderGeometry(0,.05,.2,12,1,!1));o.position.y=.5,o.updateMatrix(),a.merge(o.geometry,o.matrix);var i=new THREE.BufferGeometry;i.addAttribute("position",new THREE.Float32BufferAttribute([0,0,0,1,0,0],3));var r=new THREE.BufferGeometry;r.addAttribute("position",new THREE.Float32BufferAttribute([0,0,0,0,1,0],3));var s=new THREE.BufferGeometry;s.addAttribute("position",new THREE.Float32BufferAttribute([0,0,0,0,0,1],3)),this.handleGizmos={X:[[new THREE.Mesh(a,new t({color:16711680})),[.5,0,0],[0,0,-Math.PI/2]],[new THREE.Line(i,new e({color:16711680}))]],Y:[[new THREE.Mesh(a,new t({color:65280})),[0,.5,0]],[new THREE.Line(r,new e({color:65280}))]],Z:[[new THREE.Mesh(a,new t({color:255})),[0,0,.5],[Math.PI/2,0,0]],[new THREE.Line(s,new e({color:255}))]],XYZ:[[new THREE.Mesh(new THREE.OctahedronGeometry(.1,0),new t({color:16777215,opacity:.25})),[0,0,0],[0,0,0]]],XY:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.29,.29),new t({color:16776960,opacity:.25})),[.15,.15,0]]],YZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.29,.29),new t({color:65535,opacity:.25})),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.29,.29),new t({color:16711935,opacity:.25})),[.15,0,.15],[-Math.PI/2,0,0]]]},this.pickerGizmos={X:[[new THREE.Mesh(new THREE.CylinderBufferGeometry(.2,0,1,4,1,!1),n),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new THREE.Mesh(new THREE.CylinderBufferGeometry(.2,0,1,4,1,!1),n),[0,.6,0]]],Z:[[new THREE.Mesh(new THREE.CylinderBufferGeometry(.2,0,1,4,1,!1),n),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new THREE.Mesh(new THREE.OctahedronGeometry(.2,0),n)]],XY:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),n),[.2,.2,0]]],YZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),n),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),n),[.2,0,.2],[-Math.PI/2,0,0]]]},this.setActivePlane=function(t,e){var n=new THREE.Matrix4;e.applyMatrix4(n.getInverse(n.extractRotation(this.planes.XY.matrixWorld))),"X"===t&&(this.activePlane=this.planes.XY,Math.abs(e.y)>Math.abs(e.z)&&(this.activePlane=this.planes.XZ)),"Y"===t&&(this.activePlane=this.planes.XY,Math.abs(e.x)>Math.abs(e.z)&&(this.activePlane=this.planes.YZ)),"Z"===t&&(this.activePlane=this.planes.XZ,Math.abs(e.x)>Math.abs(e.y)&&(this.activePlane=this.planes.YZ)),"XYZ"===t&&(this.activePlane=this.planes.XYZE),"XY"===t&&(this.activePlane=this.planes.XY),"YZ"===t&&(this.activePlane=this.planes.YZ),"XZ"===t&&(this.activePlane=this.planes.XZ)},this.init()},THREE.TransformGizmoTranslate.prototype=Object.create(THREE.TransformGizmo.prototype),THREE.TransformGizmoTranslate.prototype.constructor=THREE.TransformGizmoTranslate,THREE.TransformGizmoRotate=function(){THREE.TransformGizmo.call(this);var t=function(t,e,n){var a=new THREE.BufferGeometry,o=[];n=n||1;for(var i=0;i<=64*n;++i)"x"===e&&o.push(0,Math.cos(i/32*Math.PI)*t,Math.sin(i/32*Math.PI)*t),"y"===e&&o.push(Math.cos(i/32*Math.PI)*t,0,Math.sin(i/32*Math.PI)*t),"z"===e&&o.push(Math.sin(i/32*Math.PI)*t,Math.cos(i/32*Math.PI)*t,0);return a.addAttribute("position",new THREE.Float32BufferAttribute(o,3)),a};this.handleGizmos={X:[[new THREE.Line(new t(1,"x",.5),new e({color:16711680}))]],Y:[[new THREE.Line(new t(1,"y",.5),new e({color:65280}))]],Z:[[new THREE.Line(new t(1,"z",.5),new e({color:255}))]],E:[[new THREE.Line(new t(1.25,"z",1),new e({color:13421568}))]],XYZE:[[new THREE.Line(new t(1,"z",1),new e({color:7895160}))]]},this.pickerGizmos={X:[[new THREE.Mesh(new THREE.TorusBufferGeometry(1,.12,4,12,Math.PI),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new THREE.Mesh(new THREE.TorusBufferGeometry(1,.12,4,12,Math.PI),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new THREE.Mesh(new THREE.TorusBufferGeometry(1,.12,4,12,Math.PI),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new THREE.Mesh(new THREE.TorusBufferGeometry(1.25,.12,2,24),n)]],XYZE:[[new THREE.Mesh]]},this.setActivePlane=function(t){"E"===t&&(this.activePlane=this.planes.XYZE),"X"===t&&(this.activePlane=this.planes.YZ),"Y"===t&&(this.activePlane=this.planes.XZ),"Z"===t&&(this.activePlane=this.planes.XY)},this.update=function(t,e){THREE.TransformGizmo.prototype.update.apply(this,arguments);this.handles,this.pickers;var n=new THREE.Matrix4,a=new THREE.Euler(0,0,1),o=new THREE.Quaternion,i=new THREE.Vector3(1,0,0),r=new THREE.Vector3(0,1,0),s=new THREE.Vector3(0,0,1),E=new THREE.Quaternion,c=new THREE.Quaternion,l=new THREE.Quaternion,h=e.clone();a.copy(this.planes.XY.rotation),o.setFromEuler(a),n.makeRotationFromQuaternion(o).getInverse(n),h.applyMatrix4(n),this.traverse(function(t){o.setFromEuler(a),"X"===t.name&&(E.setFromAxisAngle(i,Math.atan2(-h.y,h.z)),o.multiplyQuaternions(o,E),t.quaternion.copy(o)),"Y"===t.name&&(c.setFromAxisAngle(r,Math.atan2(h.x,h.z)),o.multiplyQuaternions(o,c),t.quaternion.copy(o)),"Z"===t.name&&(l.setFromAxisAngle(s,Math.atan2(h.y,h.x)),o.multiplyQuaternions(o,l),t.quaternion.copy(o))})},this.init()},THREE.TransformGizmoRotate.prototype=Object.create(THREE.TransformGizmo.prototype),THREE.TransformGizmoRotate.prototype.constructor=THREE.TransformGizmoRotate,THREE.TransformGizmoScale=function(){THREE.TransformGizmo.call(this);var a=new THREE.Geometry,o=new THREE.Mesh(new THREE.BoxGeometry(.125,.125,.125));o.position.y=.5,o.updateMatrix(),a.merge(o.geometry,o.matrix);var i=new THREE.BufferGeometry;i.addAttribute("position",new THREE.Float32BufferAttribute([0,0,0,1,0,0],3));var r=new THREE.BufferGeometry;r.addAttribute("position",new THREE.Float32BufferAttribute([0,0,0,0,1,0],3));var s=new THREE.BufferGeometry;s.addAttribute("position",new THREE.Float32BufferAttribute([0,0,0,0,0,1],3)),this.handleGizmos={X:[[new THREE.Mesh(a,new t({color:16711680})),[.5,0,0],[0,0,-Math.PI/2]],[new THREE.Line(i,new e({color:16711680}))]],Y:[[new THREE.Mesh(a,new t({color:65280})),[0,.5,0]],[new THREE.Line(r,new e({color:65280}))]],Z:[[new THREE.Mesh(a,new t({color:255})),[0,0,.5],[Math.PI/2,0,0]],[new THREE.Line(s,new e({color:255}))]],XYZ:[[new THREE.Mesh(new THREE.BoxBufferGeometry(.125,.125,.125),new t({color:16777215,opacity:.25}))]]},this.pickerGizmos={X:[[new THREE.Mesh(new THREE.CylinderBufferGeometry(.2,0,1,4,1,!1),n),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new THREE.Mesh(new THREE.CylinderBufferGeometry(.2,0,1,4,1,!1),n),[0,.6,0]]],Z:[[new THREE.Mesh(new THREE.CylinderBufferGeometry(.2,0,1,4,1,!1),n),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new THREE.Mesh(new THREE.BoxBufferGeometry(.4,.4,.4),n)]]},this.setActivePlane=function(t,e){var n=new THREE.Matrix4;e.applyMatrix4(n.getInverse(n.extractRotation(this.planes.XY.matrixWorld))),"X"===t&&(this.activePlane=this.planes.XY,Math.abs(e.y)>Math.abs(e.z)&&(this.activePlane=this.planes.XZ)),"Y"===t&&(this.activePlane=this.planes.XY,Math.abs(e.x)>Math.abs(e.z)&&(this.activePlane=this.planes.YZ)),"Z"===t&&(this.activePlane=this.planes.XZ,Math.abs(e.x)>Math.abs(e.y)&&(this.activePlane=this.planes.YZ)),"XYZ"===t&&(this.activePlane=this.planes.XYZE)},this.init()},THREE.TransformGizmoScale.prototype=Object.create(THREE.TransformGizmo.prototype),THREE.TransformGizmoScale.prototype.constructor=THREE.TransformGizmoScale,THREE.TransformControls=function(t,e){function n(t){if(void 0!==s.object&&!0!==l&&(void 0===t.button||0===t.button)){for(var e,n,a=t.changedTouches?t.changedTouches[0]:t,o=null===E?[c]:E,i=null,p=0,u=o.length;p<u;p++)if(n=o[p],e=r(a,h[n].pickers.children)){c=n,i=e.object.name,t.preventDefault();break}s.axis!==i&&(s.axis=i,s.update(),s.dispatchEvent(m))}}function a(t){if(void 0!==s.object&&!0!==l&&(void 0===t.button||0===t.button)){var e=t.changedTouches?t.changedTouches[0]:t;if(0===e.button||void 0===e.button){var n=r(e,h[c].pickers.children);if(n){t.preventDefault(),t.stopPropagation(),s.dispatchEvent(T),s.axis=n.object.name,s.update(),z.copy(W).sub(C).normalize(),h[c].setActivePlane(s.axis,z);var a=r(e,[h[c].activePlane]);a&&(S.copy(s.object.position),L.copy(s.object.scale),Q.extractRotation(s.object.matrix),D.extractRotation(s.object.matrixWorld),O.extractRotation(s.object.parent.matrixWorld),V.setFromMatrixScale(g.getInverse(s.object.parent.matrixWorld)),f.copy(a.point))}}l=!0}}function o(t){if(void 0!==s.object&&null!==s.axis&&!1!==l&&(void 0===t.button||0===t.button)){var e=r(t.changedTouches?t.changedTouches[0]:t,[h[c].activePlane]);!1!==e&&(t.preventDefault(),t.stopPropagation(),w.copy(e.point),"translate"===c?(w.sub(f),w.multiply(V),"local"===s.space&&(w.applyMatrix4(g.getInverse(D)),-1===s.axis.search("X")&&(w.x=0),-1===s.axis.search("Y")&&(w.y=0),-1===s.axis.search("Z")&&(w.z=0),w.applyMatrix4(Q),s.object.position.copy(S),s.object.position.add(w)),"world"!==s.space&&-1===s.axis.search("XYZ")||(-1===s.axis.search("X")&&(w.x=0),-1===s.axis.search("Y")&&(w.y=0),-1===s.axis.search("Z")&&(w.z=0),w.applyMatrix4(g.getInverse(O)),s.object.position.copy(S),s.object.position.add(w)),null!==s.translationSnap&&("local"===s.space&&s.object.position.applyMatrix4(g.getInverse(D)),-1!==s.axis.search("X")&&(s.object.position.x=Math.round(s.object.position.x/s.translationSnap)*s.translationSnap),-1!==s.axis.search("Y")&&(s.object.position.y=Math.round(s.object.position.y/s.translationSnap)*s.translationSnap),-1!==s.axis.search("Z")&&(s.object.position.z=Math.round(s.object.position.z/s.translationSnap)*s.translationSnap),"local"===s.space&&s.object.position.applyMatrix4(D))):"scale"===c?(w.sub(f),w.multiply(V),"local"===s.space&&("XYZ"===s.axis?(x=1+w.y/Math.max(L.x,L.y,L.z),s.object.scale.x=L.x*x,s.object.scale.y=L.y*x,s.object.scale.z=L.z*x):(w.applyMatrix4(g.getInverse(D)),"X"===s.axis&&(s.object.scale.x=L.x*(1+w.x/L.x)),"Y"===s.axis&&(s.object.scale.y=L.y*(1+w.y/L.y)),"Z"===s.axis&&(s.object.scale.z=L.z*(1+w.z/L.z))))):"rotate"===c&&(w.sub(C),w.multiply(V),G.copy(f).sub(C),G.multiply(V),"E"===s.axis?(w.applyMatrix4(g.getInverse(b)),G.applyMatrix4(g.getInverse(b)),v.set(Math.atan2(w.z,w.y),Math.atan2(w.x,w.z),Math.atan2(w.y,w.x)),M.set(Math.atan2(G.z,G.y),Math.atan2(G.x,G.z),Math.atan2(G.y,G.x)),P.setFromRotationMatrix(g.getInverse(O)),I.setFromAxisAngle(z,v.z-M.z),Z.setFromRotationMatrix(D),P.multiplyQuaternions(P,I),P.multiplyQuaternions(P,Z),s.object.quaternion.copy(P)):"XYZE"===s.axis?(I.setFromEuler(w.clone().cross(G).normalize()),P.setFromRotationMatrix(g.getInverse(O)),A.setFromAxisAngle(I,-w.clone().angleTo(G)),Z.setFromRotationMatrix(D),P.multiplyQuaternions(P,A),P.multiplyQuaternions(P,Z),s.object.quaternion.copy(P)):"local"===s.space?(w.applyMatrix4(g.getInverse(D)),G.applyMatrix4(g.getInverse(D)),v.set(Math.atan2(w.z,w.y),Math.atan2(w.x,w.z),Math.atan2(w.y,w.x)),M.set(Math.atan2(G.z,G.y),Math.atan2(G.x,G.z),Math.atan2(G.y,G.x)),Z.setFromRotationMatrix(Q),null!==s.rotationSnap?(A.setFromAxisAngle(X,Math.round((v.x-M.x)/s.rotationSnap)*s.rotationSnap),B.setFromAxisAngle(Y,Math.round((v.y-M.y)/s.rotationSnap)*s.rotationSnap),F.setFromAxisAngle(j,Math.round((v.z-M.z)/s.rotationSnap)*s.rotationSnap)):(A.setFromAxisAngle(X,v.x-M.x),B.setFromAxisAngle(Y,v.y-M.y),F.setFromAxisAngle(j,v.z-M.z)),"X"===s.axis&&Z.multiplyQuaternions(Z,A),"Y"===s.axis&&Z.multiplyQuaternions(Z,B),"Z"===s.axis&&Z.multiplyQuaternions(Z,F),s.object.quaternion.copy(Z)):"world"===s.space&&(v.set(Math.atan2(w.z,w.y),Math.atan2(w.x,w.z),Math.atan2(w.y,w.x)),M.set(Math.atan2(G.z,G.y),Math.atan2(G.x,G.z),Math.atan2(G.y,G.x)),P.setFromRotationMatrix(g.getInverse(O)),null!==s.rotationSnap?(A.setFromAxisAngle(X,Math.round((v.x-M.x)/s.rotationSnap)*s.rotationSnap),B.setFromAxisAngle(Y,Math.round((v.y-M.y)/s.rotationSnap)*s.rotationSnap),F.setFromAxisAngle(j,Math.round((v.z-M.z)/s.rotationSnap)*s.rotationSnap)):(A.setFromAxisAngle(X,v.x-M.x),B.setFromAxisAngle(Y,v.y-M.y),F.setFromAxisAngle(j,v.z-M.z)),Z.setFromRotationMatrix(D),"X"===s.axis&&P.multiplyQuaternions(P,A),"Y"===s.axis&&P.multiplyQuaternions(P,B),"Z"===s.axis&&P.multiplyQuaternions(P,F),P.multiplyQuaternions(P,Z),s.object.quaternion.copy(P))),s.update(),s.dispatchEvent(m),s.dispatchEvent(y))}}function i(t){t.preventDefault(),void 0!==t.button&&0!==t.button||(l&&null!==s.axis&&(R.mode=c,s.dispatchEvent(R)),l=!1,"TouchEvent"in window&&t instanceof TouchEvent?(s.axis=null,s.update(),s.dispatchEvent(m)):n(t))}function r(n,a){var o=e.getBoundingClientRect(),i=(n.clientX-o.left)/o.width,r=(n.clientY-o.top)/o.height;H.set(2*i-1,-2*r+1),d.setFromCamera(H,t);var s=d.intersectObjects(a,!0);return!!s[0]&&s[0]}THREE.Object3D.call(this),e=void 0!==e?e:document,this.object=void 0,this.visible=!1,this.translationSnap=null,this.rotationSnap=null,this.space="world",this.size=1,this.axis=null;var s=this,E=null,c="translate",l=!1,h={translate:new THREE.TransformGizmoTranslate,rotate:new THREE.TransformGizmoRotate,scale:new THREE.TransformGizmoScale};for(var p in h){var u=h[p];u.visible=p===c,this.add(u)}var m={type:"change"},T={type:"mouseDown"},R={type:"mouseUp",mode:c},y={type:"objectChange"},d=new THREE.Raycaster,H=new THREE.Vector2,w=new THREE.Vector3,f=new THREE.Vector3,v=new THREE.Vector3,M=new THREE.Vector3,x=1,b=new THREE.Matrix4,z=new THREE.Vector3,g=new THREE.Matrix4,G=new THREE.Vector3,P=new THREE.Quaternion,X=new THREE.Vector3(1,0,0),Y=new THREE.Vector3(0,1,0),j=new THREE.Vector3(0,0,1),Z=new THREE.Quaternion,A=new THREE.Quaternion,B=new THREE.Quaternion,F=new THREE.Quaternion,I=new THREE.Quaternion,S=new THREE.Vector3,L=new THREE.Vector3,Q=new THREE.Matrix4,O=new THREE.Matrix4,V=new THREE.Vector3,C=new THREE.Vector3,k=new THREE.Euler,D=new THREE.Matrix4,W=new THREE.Vector3,q=new THREE.Euler;e.addEventListener("mousedown",a,!1),e.addEventListener("touchstart",a,!1),e.addEventListener("mousemove",n,!1),e.addEventListener("touchmove",n,!1),e.addEventListener("mousemove",o,!1),e.addEventListener("touchmove",o,!1),e.addEventListener("mouseup",i,!1),e.addEventListener("mouseout",i,!1),e.addEventListener("touchend",i,!1),e.addEventListener("touchcancel",i,!1),e.addEventListener("touchleave",i,!1),this.dispose=function(){e.removeEventListener("mousedown",a),e.removeEventListener("touchstart",a),e.removeEventListener("mousemove",n),e.removeEventListener("touchmove",n),e.removeEventListener("mousemove",o),e.removeEventListener("touchmove",o),e.removeEventListener("mouseup",i),e.removeEventListener("mouseout",i),e.removeEventListener("touchend",i),e.removeEventListener("touchcancel",i),e.removeEventListener("touchleave",i)},this.attach=function(t){this.object=t,this.visible=!0,this.update()},this.detach=function(){this.object=void 0,this.visible=!1,this.axis=null},this.getMode=function(){return c},this.setMode=function(t){c=t||c,E=null,s.space="scale"===c?"local":"world";for(var e in h)h[e].visible=e===c;this.update(),s.dispatchEvent(m)},this.setModes=function(t){if(t&&t instanceof Array){for(var e=0,n=(E=t).length;e<n;e++)"scale"===E[e]&&(s.space="local");for(var a in h)h[a].visible=E.indexOf(a)>-1;this.update(),s.dispatchEvent(m)}else console.error("modes must be an array!!")},this.setTranslationSnap=function(t){s.translationSnap=t},this.setRotationSnap=function(t){s.rotationSnap=t},this.setSize=function(t){s.size=t,this.update(),s.dispatchEvent(m)},this.setSpace=function(t){s.space=t,this.update(),s.dispatchEvent(m)},this.update=function(){if(void 0!==s.object){s.object.updateMatrixWorld(),C.setFromMatrixPosition(s.object.matrixWorld),k.setFromRotationMatrix(g.extractRotation(s.object.matrixWorld)),t.updateMatrixWorld(),W.setFromMatrixPosition(t.matrixWorld),q.setFromRotationMatrix(g.extractRotation(t.matrixWorld)),x=C.distanceTo(W)/6*s.size,this.position.copy(C),this.scale.set(x,x,x),t instanceof THREE.PerspectiveCamera?z.copy(W).sub(C).normalize():t instanceof THREE.OrthographicCamera&&z.copy(W).normalize();for(var e,n=null===E?[c]:E,a=0,o=n.length;a<o;a++)e=n[a],"local"===s.space?h[e].update(k,z):"world"===s.space&&h[e].update(new THREE.Euler,z),e===c&&h[e].highlight(s.axis)}}},THREE.TransformControls.prototype=Object.create(THREE.Object3D.prototype),THREE.TransformControls.prototype.constructor=THREE.TransformControls}();
