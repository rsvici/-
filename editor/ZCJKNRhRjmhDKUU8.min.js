THREE.DDSLoader=function(){this._parser=THREE.DDSLoader.parse},THREE.DDSLoader.prototype=Object.create(THREE.CompressedTextureLoader.prototype),THREE.DDSLoader.prototype.constructor=THREE.DDSLoader,THREE.DDSLoader.parse=function(r,a){function e(r){return r.charCodeAt(0)+(r.charCodeAt(1)<<8)+(r.charCodeAt(2)<<16)+(r.charCodeAt(3)<<24)}var t={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},o=e("DXT1"),n=e("DXT3"),m=e("DXT5"),i=e("ETC1"),p=new Int32Array(r,0,31);if(542327876!==p[0])return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),t;if(4&!p[20])return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),t;var E,u=p[21],s=!1;switch(u){case o:E=8,t.format=THREE.RGB_S3TC_DXT1_Format;break;case n:E=16,t.format=THREE.RGBA_S3TC_DXT3_Format;break;case m:E=16,t.format=THREE.RGBA_S3TC_DXT5_Format;break;case i:E=8,t.format=THREE.RGB_ETC1_Format;break;default:if(!(32===p[22]&&16711680&p[23]&&65280&p[24]&&255&p[25]&&4278190080&p[26]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",function(r){return String.fromCharCode(255&r,r>>8&255,r>>16&255,r>>24&255)}(u)),t;s=!0,E=64,t.format=THREE.RGBAFormat}t.mipmapCount=1,131072&p[2]&&!1!==a&&(t.mipmapCount=Math.max(1,p[7]));var c=p[28];if(t.isCubemap=!!(512&c),t.isCubemap&&(!(1024&c)||!(2048&c)||!(4096&c)||!(8192&c)||!(16384&c)||!(32768&c)))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),t;t.width=p[4],t.height=p[3];for(var d=p[1]+4,D=t.isCubemap?6:1,T=0;T<D;T++)for(var h=t.width,f=t.height,C=0;C<t.mipmapCount;C++){if(s)R=(H=function(r,a,e,t){for(var o=e*t*4,n=new Uint8Array(r,a,o),m=new Uint8Array(o),i=0,p=0,E=0;E<t;E++)for(var u=0;u<e;u++){var s=n[p],c=n[++p],d=n[++p],D=n[++p];p++,m[i]=d,m[++i]=c,m[++i]=s,m[++i]=D,i++}return m}(r,d,h,f)).length;else var R=Math.max(4,h)/4*Math.max(4,f)/4*E,H=new Uint8Array(r,d,R);var S={data:H,width:h,height:f};t.mipmaps.push(S),d+=R,h=Math.max(h>>1,1),f=Math.max(f>>1,1)}return t};
