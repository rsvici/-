THREE.ToonPass=function(e,r,t,a){this.renderScene=r,this.renderCamera=t,this.params={wireColor:a.wireColor||new THREE.Color(0,0,0),wireAlpha:a.wireAlpha||1},THREE.Pass.call(this),this.resolution=void 0!==e?new THREE.Vector2(e.x,e.y):new THREE.Vector2(256,256);var i={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat};this.normalMaterial=new THREE.MeshNormalMaterial,this.depthMaterial=new THREE.MeshDepthMaterial,this.depthTexture=new THREE.WebGLRenderTarget(this.resolution.x,this.resolution.y,i),this.depthTexture.texture.generateMipmaps=!1,this.normalTexture=new THREE.WebGLRenderTarget(this.resolution.x,this.resolution.y,i),this.normalTexture.texture.generateMipmaps=!1,this.composeMaterial=new THREE.ToonComposeMaterial(this.params.blendingType),this.composeMaterial.uniforms.depthtexture.value=this.depthTexture,this.composeMaterial.uniforms.normaltexture.value=this.normalTexture,this.enabled=!0,this.needsSwap=!1,this.renderToScreen=!1,this.oldClearColor=new THREE.Color,this.oldClearAlpha=1,this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new THREE.Scene,this.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),this.composeMaterial),this.quad.frustumCulled=!1,this.scene.add(this.quad)},THREE.ToonPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.ToonPass,dispose:function(){this.depthTexture.dispose(),this.normalTexture.dispose()},setSize:function(e,r){this.depthTexture.setSize(e,r),this.normalTexture.setSize(e,r)},render:function(e,r,t,a,i){this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();var s=e.autoClear;e.autoClear=!1,e.setClearColor(16777215,0),this.composeMaterial.uniforms.wireColor.value=this.params.wireColor,this.composeMaterial.uniforms.wireAlpha.value=this.params.wireAlpha,this.renderScene.overrideMaterial=this.depthMaterial,e.clearTarget(this.depthTexture,!0,!0),e.render(this.renderScene,this.renderCamera,this.depthTexture),this.renderScene.overrideMaterial=this.normalMaterial,e.clearTarget(this.normalTexture,!0,!0),e.render(this.renderScene,this.renderCamera,this.normalTexture),this.renderScene.overrideMaterial=null,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,!1),e.setClearColor(this.oldClearColor,this.oldClearAlpha),e.autoClear=s}});
